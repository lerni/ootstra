@use "sass:math";
@import '~breakpoint-sass/stylesheets/breakpoint';
@import 'includes/variables';
@import 'includes/defaults';
@import 'includes/mixins';
@import 'includes/utils';
@import 'swiper';
@import 'includes/typography';

// Many styles
@import 'components/*';

/* Layout
---------------------------------------------------------------------------------- */

html, body {
	width: 100%;
	margin: 0;
	@include print {
		height: 99%;
		page-break-after: auto;
	}
}

html {
	letter-spacing: .04em;
	font-size: #{$lauftext-size};
	font-family: $font-family;
	line-height: $lh;
	color: $lauftext-color;
	@include normal;
	@include smoothFonts;
}

body {
	height: 100vh;
	height: stretch;
	display: flex;
	flex-direction: column;
	min-height: 100vh;
	background-color: $white;
	// overflow is ignored with mobile
	// https://stackoverflow.com/questions/24193272/overflow-xhidden-on-mobile-device-not-working
	overflow-x: hidden;
	@include breakpoint($Lneg) {
		font-size: #{$lauftext-size*.9};
	}
	@include breakpoint($Sneg) {
		font-size: #{$lauftext-size*.8};
	}
}

@supports (-webkit-touch-callout: none) {
	body {
	  height: -webkit-fill-available;
	}
}

// #BetterNavigator {
// 	display:none !important;
// }

#header {
	display: flex;
	flex: 0 0 $headerheight;
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	z-index: 200;
	width: 100%;
	height: $headerheight;
	will-change: transform, height;
	transition: transform .2s ease-out;
	transform: translateY(0%);
	box-shadow: none;
	background-color: rgba($white, .97);
	@include breakpoint($Lneg) {
		@include small-header();
	}
	// @include breakpoint($Sneg) {
	// 	flex: 0 0 $headerheight--smaller;
	// 	height: $headerheight--smaller;
	// }
	.inner {
		display: flex;
		// max-width: calc(#{$inner-width + 200px});
		.column {
			justify-content: flex-end;
			flex-direction: column;
			&.logo {
				flex: 0 0 220px;
				a {
					display: table;
					svg,
					img {
						height: auto;
						max-width: 185px;
						margin: auto auto 0 0;
					}
				}
			}
			&.nav {
				// this things are living in _menu.scss
			}
		}
	}
	&.headroom {
		&.headroom--top {
			// shuldn't do anything here to prevent fouc
		}
		&.headroom--not-top {
			box-shadow: 0 0 .7em rgba($black, .3);
			@include small-header();
		}
		&.headroom--pinned  {
			transform: translateY(0%);
		}
		&.headroom--unpinned {
			transform: translateY(-100%);
		}
	}
}

main.typography {
	width: 100%;
	flex: 1 1 auto;
	border-top: $headerheight solid transparent;
	// @include breakpoint($XLneg) {
	// 	overflow-x: hidden;
	// }
	@include breakpoint($Lneg) {
		border-top-width: $headerheight--smaller;
	}
	// @include breakpoint($Sneg) {
	// 	border-top-width: $headerheight--smaller;
	// }
	@include ie11 {
		flex: 1 0 auto;
	}
}

.inner {
	width:100%;
	max-width: $inner-width;
	margin: 0 auto;
	padding-left: #{$lh*1}em;
	padding-right: #{$lh*1}em;
	@include breakpoint($Mneg) {
		padding-left: #{math.div($lh, 2)}em;
		padding-right: #{math.div($lh, 2)}em;
	}
}

.breadcrumbs {
	padding-bottom: #{math.div($lh, 2)}em;
	text-align: center;
	@include bold;
	a, span, .delimiter {
		font-size: .9em;
	}
	a {
		@include normal;
		color: $lauftext-color;
	}
	.delimiter {
		display: inline-block;
		width: 1em;
		height: 1em;
		margin: 0 .2em;
		background-repeat: no-repeat;
		background-image: svg-load('../images/svg/delimiter.svg');
		background-position: bottom center;
		background-size: .3em;
	}
}

.typography p.cat-tag {
	display: flex;
	flex-wrap: wrap;
	justify-content: center;
	margin-bottom: 0;
	font-size: .9em;
	>span,
	>a {
		display: inline-block;
		margin: 0 #{math.div($lh, 2)}em #{math.div($lh, 2)}em 0;
		padding: .3em 1.2em .2em;
		border-width: 2px;
		border-style: solid;
		border-color: $link-color;
		color: $link-color;
		&:last-child {
			margin-right: 0;
		}
		&.current {
			color: $white;
			background-color: $link-color;
		}
		&:not(.current) {
			background-color: transparent;
		}
	}
	>a.all:not(.current) {
		border-color: transparent;
		padding-left: 0;
		padding-right: 1em;
		&::before {
			display: inline-block;
			content: "";
			width: .9em;
			height: 1em;
			background-size: auto .7em;
			background-repeat: no-repeat;
			background-position: right 0 center;
			background-image: svg-load('../images/svg/arrow.svg', fill=#{$link-color});
			transform: rotate(180deg);
			margin-right: .5em;
			vertical-align: -.1em;
		}
	}
}

.element {
	position: relative;
	width: 100%;
	margin-left: auto;
	margin-right: auto;
	&:not(.full-width):not(.elementhero.default) {
		max-width: $inner-width;
		padding-left: #{$lh}em;
		padding-right: #{$lh}em;
		@include breakpoint($Mneg) {
			padding-left: #{math.div($lh, 2)}em;
			padding-right: #{math.div($lh, 2)}em;
		}
	}
	&.background--gray-lighter {
		position: relative;
		z-index: 1;
		&::after {
			content: "";
			position: absolute;
			z-index: -1;
			top: 0;
			right: -100%;
			bottom: 0;
			left: -100%;
			background-color: $gray--lighter;
		}
	}
	.element-title {
		flex: 0 0 100%;
	}
	&.elementjobs.show,
	&.elementform,
	&.elementcontent,
	&.elementcontentsection,
	.page & {
		.inner {
			>*:not(.embed) {
				max-width: $inner-width--reduced;
				margin-left: 0;
				margin-right: auto;
			}
		}
	}
	&.elementcontent {
		.typography {
			>*:last-child {
				margin-bottom: 0;
			}
		}
	}
	&.elementhero {
		display: block; // swiper.js shouldn't life in a display: table element otherwise layout breaks
		// with DefaultHero the image is not wrapped with swiper divs
		position: relative;
		figure {
			height: 100%;
			width: 100%;
			margin: 0;
			position: relative;
			img {
				height: 100%;
				width: 100%;
				display: table; // testing to have image tihght in container
				object-fit: cover;
				max-width: none;
				margin-bottom: 0;
				// max-height: 500px;
				@include breakpoint($Mneg) {
					height: 180px;
				}
			}
		}
		.medium figure {
			padding: 0 0 45.1388888888889% 0;
			height: 0;
			@include breakpoint($Mneg) {
				padding: 0 0 56.25% 0;
			}
			@include breakpoint($Sneg) {
				padding: 0 0 80% 0;
			}
			img {
				position: absolute;
				max-width: none;
				// width: 100% !important;
				@include breakpoint($Mplus) {
					min-height: 100% !important;
				}
			}
		}
		.txt {
			position: absolute;
			top: 0;
			bottom: 0;
			left: 0;
			right: 0;
			.inner {
				height: 100%;
				display: flex;
				flex-direction: column;
				justify-content: flex-end;
				align-items: flex-end;
				.spacer {
					margin: 0;
					width: 100%;
					max-width: $inner-width--reduced;
					display: flex;
					flex-direction: column;
				}
				p, h1, h2, h3 {
					font-size: 1.5em;
					text-shadow: 0 0 .7em rgba($lauftext-color, .5);
					color: $white;
				}
				h1, h2, h3 {
					// @include medium;
					margin: 0;
				}
				p {
					@include normal;
					margin-bottom: 0;
					padding: #{math.div($lh, 2)}em 0;
				}
			}
			&.upper-left .inner {
				padding-top: #{$lh}em;
				justify-content: flex-start;
				align-items: flex-start;
				.spacer {
					margin: 0 auto auto 0;
				}
				p, h1, h2, h3 {
					text-align: left;
				}
			}
			&.upper-right .inner {
				padding-top: #{$lh}em;
				justify-content: flex-end;
				align-items: flex-start;
				.spacer {
					margin: 0 0 auto auto;
				}
				p, h1, h2, h3 {
					text-align: right;
				}
			}
			&.lower-left .inner {
				justify-content: flex-start;
				align-items: flex-start;
				.spacer {
					margin: auto auto 0 0;
				}
				p, h1, h2, h3 {
					text-align: left;
				}
			}
			&.lower-center .inner {
				justify-content: center;
				align-items: flex-end;
				.spacer {
					margin: auto auto 0 auto;
				}
				p, h1, h2, h3 {
					text-align: center;
				}
			}
			&.lower-right .inner {
				justify-content: flex-end;
				align-items: flex-end;
				.spacer {
					margin: auto 0 0 auto;
				}
				p, h1, h2, h3 {
					text-align: right;
				}
			}
			&.center .inner {
				justify-content: center;
				align-items: center;
				.spacer {
					margin: auto;
				}
				p, h1, h2, h3 {
					text-align: center;
				}
			}
			@include breakpoint($Lneg) {
				position: inherit;
				.spacer {
					padding: #{math.div($lh, 2)}em 0 0 0;
					position: relative;
					&::after {
						content: "";
						position: absolute;
						left: -#{$lh}em;
						right: -#{$lh}em;
						top: 0;
						bottom: 0;
						pointer-events: none;
						background-color: $gray--light;
						z-index: 0;
					}
					p, h1, h2, h3 {
						font-size: 1em;
						text-shadow: none;
						color: $lauftext-color;
						position: relative;
						z-index: 1;
					}
				}
			}
		}
		.embed-hero {
			width: 100% !important;
			padding: 0 0 45.1388888888889% 0;
			margin-bottom: 0;
			height: 0;
			@include breakpoint($Mneg) {
				padding: 0 0 56.25% 0;
			}
			@include breakpoint($Sneg) {
				padding: 0 0 80% 0;
			}
			iframe {
				margin-top: -8%;
				margin-bottom: auto;
				margin-left: auto;
				margin-right: auto;
				// pointer-events: none;
				position: absolute;
				width: 100% !important;
				min-height: 100% !important;
				transition-property: opacity;
				transition: .3s linear;
				transform-origin: 50% 50%;
				@include breakpoint($Mneg) {
					margin-top: 0;
					margin-bottom: 0;
					transform: scale(1.5); // mostly to hide youtube branding
				}
			}
			&:not(.paused-mode):not(.playing-mode) iframe {
				display: none;
			}
			&.playing-mode {
				display: block !important; // we need to override inline style
				.overlayer {
					// background-color: rgba(yellowgreen, .099);
				}
			}
			.overlayer {
				position: absolute;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;
				background-color: transparent;
				// background-color: rgba(fuchsia, .098);
			}
		}
		.embed-hero.playing-mode + figure {
			display: none;
		}
		.swiper-container.hero {
			overflow: hidden;
			&.medium figure img {
				max-height: 700px;
			}
			&.fullscreen {
				height: calc(100vh - var(--vh-offset));
				figure img {
					max-height: none;
				}
			}
			.swiper-wrapper {
				height: 100%;
				.swiper-slide {
					height: 100%;
					opacity: 1;
				}
			}
		}

		.swiper-container.do-not-crop.medium {
			figure {
				img {
					max-height: initial;
					object-fit: initial;
				}
			}
		}

		// .headroom--top &.fullscreen:first-of-type .scroll {
		@keyframes bounce {
			0%, 20%, 50%, 80%, 100% {
				transform: translateY(0);
				opacity: 6;
			}
			40% {
				transform: translateY(-20px);
				opacity: .6;
			}
			60% {
				transform: translateY(-10px);
				opacity: .8;
			}
		}
		.scroll {
			display:none;
			will-change: transform, opacity;
			transition: transform, opacity;
			transition-duration: 160ms;
			background-repeat: no-repeat;
			background-image: svg-load('../images/svg/mouse.svg');
			background-position: bottom center;
			background-size: 100%;
			width: 1.5em;
			height: 3.4em;
			position: absolute;
			bottom: 2%;
			left: calc(50% - 1.25em);
			z-index: 100;
			cursor: pointer;
		}

		#header:not(.headroom--unpinned) + & .swiper-container.fullscreen .scroll {
			display: block;
			animation: bounce 1.6s ease-in-out infinite;
		}

		@include sliderpagination(1, $white);

		.swiper-button-prev,
		.swiper-button-next {
			color: $white;
		}

		&.default {
			display: table;
		}
		&.breadcrumbs {
			padding-bottom: #{math.div($lh, 2)}em;
			margin-bottom: 0;
		}
		&.global-alert {
			padding-bottom: 0 !important;
		}
	}
	&.elementmaps {
		display: flex;
		flex-wrap: wrap;
		p.gm-style-pbt {
			font-size: initial;
		}
		img {
			max-width: none;
			margin-bottom: initial; // checbox-placing otherwise clashes with typography img
		}
		.txt {
			padding: 0 #{$lh}em #{$lh}em 0;
			@include breakpoint($Lplus) {
				flex: 0 0 50%;
			}
		}

		#map_canvas {
			box-sizing: unset;
			height: 0;
			width: 100%;
			flex: 0 0 100%;
			padding-bottom: 45%;
			&.has-txt {
				@include breakpoint($Lplus) {
					flex: 0 0 50%;
				}
			}
			@include breakpoint($Lneg) {
				padding-bottom: 60%;
			}
			@include breakpoint($Mneg) {
				padding-bottom: 100%;
			}
		}
	}
	&.elementtextimage {
		// this things are living in textimage.scss
	}
	&.elementperso {
		// this things are living in perso.scss
	}
	&.elementcontentsection {
		// this things are living in contentsections.scss
	}
	&.elementlogo {
		// this things are living in logo.scss
	}
	&.elementjobs {
		.jobs {
			display: flex;
			flex-wrap: wrap;
			justify-content: center;
			width: calc(100% - #{$lh}em);
			a {
				flex: 0 0 calc(percentage(math.div(1, 3)) - #{$lh}em);
				display: flex;
				flex-direction: column;
				margin: #{$lh}em #{math.div($lh, 2)}em;
				figure {
					flex: 0 0 auto;
					margin: 0;
					img {
						width: 100%;
						float: left;
						margin-bottom: 0;
					}
				}
				.txt {
					flex: 1 0 auto;
					margin: #{math.div($lh, 2)}em 0 auto 0;
				}
			}
		}
	}
	$min-spacing: 0;
	$max-spacing: 6;
	@for $i from $max-spacing through $min-spacing {
		&.spacing-bottom-#{$i} {
			padding-bottom: #{$lh*$i}em;
		}
		$i1: $i + 1;
	}
	@for $i from $max-spacing through $min-spacing {
		&.spacing-top-#{$i} {
			padding-top: #{$lh*$i}em;
		}
		$i1: $i + 1;
	}
}

@media print {
	footer, //  .upper .inner .sitemap,
	.overlay,
	.service-nav {
		display: none;
	}
	.header-pic .inner img {
		left: 0;
	}
	.inner {
		max-width: 100%;
	}
}
@page {
	size: 297mm 210mm;
	margin: 15mm;
}

// todo - unify/cleanup styles
// this is use in ElementPage_job
// classes are same as in backend
// how does userform handle such things?
.alert {
	border: 1px solid;
	padding: #{math.div($lh, 2)}em;
	border-radius: #{math.div($lh, 4)}em;
	margin-bottom: #{math.div($lh, 2)}em;
	&.alert-warning {
		background-color: rgba($red, .1);
		border-color: rgba($red, 1);
	}
}

.pseudolink {
	display: inline-block;
	color: #{$link-color};
	@extend %forth;
}

.parent-link.back {
	display: inline-block;
	color: #{$link-color};
	@extend %back;
}

.global-alert:not(.elementhero) {
	background-color: $blue;
	padding: #{math.div($lh, 2)}em 0;
	margin-bottom: #{$lh}em;
	.inner >* {
		color: $white;
		&:last-child {
			margin-bottom: 0;
		}
	}
}

.social-icons {
	margin: auto 0 0;
	a {
		display: inline-block;
		color: $white;
		margin-top:  #{$lh}em;
		transition: transform .05s linear;
		&:not(:last-of-type) {
			margin-right: #{math.div($lh, 1)}em;
		}
		&:hover {
			color: $white;
			transform: scale(1.08);
		}
	}
}

// !klaro
html .klaro {

	.cookie-modal,
	.cookie-notice {
		a {
			color: lighten($link-color, 70%);
		}
		.cm-btn {
			cursor: pointer;
			font-size: 14px
		}
	}

	.cookie-notice {
		.cn-ok {
			display: flex;
			flex-wrap: wrap;
			justify-content: flex-start !important;
				.cn-buttons {
				order: 1;
				// decline
				.cm-btn.cn-decline {
					background-color: $gray;
					order: 1;
				}
				// accept all
				.cm-btn.cm-btn-success {
					background-color: $link-color;
					order: 0;
				}
			}
			// modal link
			.cn-learn-more {
				display: block;
				margin-top: .6em;
				order: 2;
				flex: 0 0 100%;
			}
		}
	}

	.cookie-modal {
		.cm-app-title {
			font-size: 14px;
		}
		// switch disabled
		.cm-list-label .slider {
			background-color: $gray--light;
		}
		// slider-switches
		.cm-list-input:checked + .cm-list-label .slider {
			background-color: $link-color;
		}
		// required switch enabled
		.cm-list-input.required:checked + .cm-list-label .slider {
			background-color: darken($link-color, 10%);
			&::before {
				background-color: darken($white, 16%);
			}
		}
		// halve is used on parent if children are on & off
		.cm-list-input.half-checked:checked + .cm-list-label .slider {
			background-color: mix($link-color, $white, 71%);
		}
		.cm-list-description {
			color: $gray--light;
		}
		// accept all
		.cm-btn.cm-btn-accept-all {
			background-color: $link-color;
		}
		// save selection, decline
		.cm-btn.cm-btn-accept,
		.cm-btn.cm-btn-decline {
			background-color: $gray;
		}
		// klaro link
		.cm-modal .cm-footer .cm-powered-by {
			display: none;
		}
	}
}
