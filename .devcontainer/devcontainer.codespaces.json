{
  "name": "GitHub Codespaces - DDEV",

  "image": "mcr.microsoft.com/devcontainers/base:debian-12",

  "features": {
    "ghcr.io/devcontainers/features/docker-in-docker:2": {
      "version": "latest"
    },
    "ghcr.io/ddev/ddev/install-ddev:latest": {}
  },

  "customizations": {
    "vscode": {
      "extensions": [
        // PHP
        "phpactor.vscode-phpactor",
        "junstyle.php-cs-fixer",
        "xdebug.php-debug",

        // SilverStripe
        "adrian.silverstripe",

        // JavaScript/TypeScript
        "biomejs.biome",

        // Utilities
        "berublan.vscode-log-viewer",
        "editorconfig.editorconfig",
        "mikestead.dotenv",
        "mhutchie.git-graph"
      ],

      "settings": {
        // VS Code PHP
        "vscode.php-language-features": false,
        "php.validate.executablePath": "/usr/bin/php",

        // Phpactor
        "phpactor.enable": true,
        "phpactor.path": "/usr/local/bin/phpactor",

        // PHP CS Fixer
        "php-cs-fixer.executablePath": "${workspaceFolder}/vendor/bin/php-cs-fixer",
        "php-cs-fixer.onsave": true,
        "php-cs-fixer.rules": "@PSR12",

        // Biome
        "biome.enabled": false,
        "biome.lsp.bin": "${workspaceFolder}/themes/default/node_modules/.bin/biome",

        // Editor
        "[php]": {
          "editor.defaultFormatter": "junstyle.php-cs-fixer"
        },
        "[javascript]": {
          "editor.defaultFormatter": "biomejs.biome"
        },
        "[typescript]": {
          "editor.defaultFormatter": "biomejs.biome"
        },
        "[json]": {
          "editor.defaultFormatter": "biomejs.biome"
        },
        "[jsonc]": {
          "editor.defaultFormatter": "biomejs.biome"
        },

        "editor.linkedEditing": true,
        "editor.stickyScroll.enabled": true,
        "workbench.tree.enableStickyScroll": true,

        // Terminal
        "terminal.integrated.scrollback": 10000,

        // Search
        "search.followSymlinks": false,
        "search.useIgnoreFiles": false,

        // Log Viewer
        "logViewer.watch": [
          {
            "title": "Silverstripe",
            "pattern": "silverstripe.log"
          }
        ],

        // Telemetry
        "telemetry.telemetryLevel": "off"
      }
    }
  },

  "portsAttributes": {
    "3306": {
      "label": "database",
      "onAutoForward": "silent"
    },
    "8027": {
      "label": "mailpit",
      "onAutoForward": "silent"
    },
    "8080": {
      "label": "web http",
      "onAutoForward": "notify"
    },
    "8443": {
      "label": "web https",
      "onAutoForward": "openBrowser"
    },
    "5173": {
      "label": "vite",
      "onAutoForward": "silent"
    },
    "9003": {
      "label": "xdebug",
      "onAutoForward": "silent"
    }
  },

  "postCreateCommand": "bash .devcontainer/setup_project.sh"
}
